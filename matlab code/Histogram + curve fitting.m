clc
clearvars
close all

sfc_num= [10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75];
VNEM_time_5 = [0.0025186000000001485, 0.0015871999999998998, 0.0016080999999998902, 0.0015382000000001561, 0.001678200000000185, 0.001513899999999957, 0.003917699999999691, 0.004557700000000331, 0.001749400000000012, 0.00997899999999996, 0.008214600000000072, 0.005002999999999869, 0.003736399999999751, 0.004261200000000187, 0.004839999999999733, 0.006439400000000095, 0.0025452000000001362, 0.002376900000000237, 0.0020658000000000065, 0.006983500000000031, 0.018102299999999794, 0.010023499999999963, 0.012097599999999709, 0.010394499999999418, 0.002503099999999314, 0.006197499999999856, 0.009089699999999645, 0.0014044999999995866, 0.010774600000000412, 0.004137100000000338, 0.00363639999999954, 0.012530599999999836, 0.010812300000000441, 0.007952799999999982, 0.008006700000000144, 0.002500099999999783, 0.006894199999999628, 0.005924400000000496, 0.0030654999999999433, 0.001061100000000259, 0.005198599999999942, 0.002270700000000403, 7.5999999999964984e-06, 0.001787000000000205, 0.007197300000001405, 0.00249879999999969, 5.999999999062311e-06, 0.0025426999999993427, 0.005005999999999844, 0.000894199999999401, 0.014080099999999263, 0.009711600000001042, 0.005351100000000386, 0.006147499999999084, 0.002411000000000385, 0.007883400000000762, 0.010600200000000726, 5.800000000277805e-06, 0.0013848999999996892, 0.0012630000000015684, 0.0022082000000001045, 0.006868700000000061, 0.0018262999999993923, 0.007272500000000903, 3.6999999988296395e-06, 5.900000001446415e-06] ;
VNEM_time_10 = [8.100000000066387e-06, 0.01389420000000019, 0.0031536000000000897, 8.400000000019503e-06, 0.0051448000000000604, 0.0016089999999997495, 0.004808799999999724, 1.0599999999971743e-05, 1.0899999999924859e-05, 0.002075499999999675, 1.0699999999808085e-05, 0.004743799999999965, 0.008091000000000292, 0.0008834999999995929, 0.004234699999999592, 0.003601499999999813, 2.6099999999917856e-05, 8.000000000230045e-06, 1.430000000013365e-05, 0.005435400000000534, 0.004924400000000162, 1.8199999999524152e-05, 0.010104399999999458, 0.0035555000000000447, 0.0029018000000000654, 0.006654600000000066, 0.009272700000000356, 0.01567749999999979, 0.007541299999999751, 0.007007900000000511, 0.002457399999999943, 0.017691400000000357, 0.006040999999999741, 0.007567199999999552, 0.0022486999999999924, 0.0015118000000002851, 0.005146100000000153, 0.01155039999999996, 0.004720799999999414, 0.00584920000000011, 0.012242699999999829, 0.010715799999999831, 0.005027600000000021, 0.001958499999998864, 0.016469100000000125, 0.0014887999999988466, 0.0048615999999999104, 0.010788899999999657, 0.002626199999999912, 0.007772899999999083, 0.007848799999999656, 0.0077104999999999535, 0.0016508999999995666, 0.004192400000000873, 0.006054400000000015, 0.002628699999998929, 0.0014228000000002794, 0.008352699999999658, 0.0072574000000003025, 0.0015118000000011733, 0.010161899999999946, 0.010034900000000846, 0.0014451999999991472, 0.008228400000000136, 0.007572100000000859, 0.009406999999999499] ;
VNEM_time_15 = [6.5999999998567205e-06, 8.600000000136276e-06, 9.799999999948739e-06, 9.200000000042508e-06, 8.80000000025305e-06, 0.0015828999999998317, 1.0300000000018628e-05, 0.004458500000000143, 1.1399999999994748e-05, 1.1699999999947863e-05, 0.008214000000000166, 1.3399999999830214e-05, 1.320000000015753e-05, 1.4999999999876223e-05, 1.3199999999713441e-05, 0.0027254999999999363, 1.4999999999876223e-05, 1.3599999999946988e-05, 1.430000000013365e-05, 2.5599999999847967e-05, 1.7799999999290606e-05, 0.0015692000000004924, 2.700000000022129e-05, 0.007540599999999564, 0.0016057000000007093, 0.00971019999999978, 0.005901799999999291, 2.7199999999893976e-05, 0.007189599999999352, 0.002517399999999448, 0.0035071999999995995, 0.018420599999999787, 0.004114400000000629, 0.00656080000000081, 0.0024242999999994908, 0.002185899999999741, 0.006369299999999356, 0.008011500000000282, 0.004481700000000366, 0.013109000000000037, 0.006477900000000147, 0.0025143000000005244, 0.0076897000000002436, 0.00728490000000015, 0.009724600000000194, 0.011575999999999809, 0.002242199999999528, 0.010448900000000094, 0.02704740000000072, 0.003158700000000181, 0.014547600000000216, 0.014598999999998696, 0.026778099999999583, 0.007345799999999514, 0.022099400000000102, 0.021188499999999166, 0.011944100000000901, 0.0038391999999998205, 0.013044099999998338, 0.008091300000000246, 0.007674000000001513, 0.003589700000000917, 0.00589469999999892, 0.013688900000000004, 0.0167666999999998, 0.01026600000000144] ;

% VNEM_time_5 = [0.0072182999999999, 0.0014526000000003592, 0.008269299999999813, 0.009965000000000224, 0.004119699999999948, 0.0015658000000002836, 0.0030413000000000245, 6.999999999646178e-06, 0.011952599999999869, 1.2399999999690436e-05, 0.0016751999999997658, 0.0010183999999999749, 0.005545500000000203, 0.007578400000000318, 0.004246399999999539, 0.011078699999999664, 0.01819850000000045, 0.00805189999999989, 0.005903900000000739, 0.011128499999999875, 0.011505200000000215, 0.007681200000000388, 0.009280300000000352, 0.007352200000000586, 0.019930399999999793, 0.0014281000000000432, 0.010980999999999241, 0.011601399999999984, 0.010013700000000014, 0.010417300000000296, 0.00818099999999955, 0.005540400000000112, 0.013107200000000319, 8.79999999980896e-06, 0.011220200000000347, 0.005907099999999943, 0.012149299999999918, 0.002544599999999342, 7.899999999949614e-06, 0.004283900000000784, 0.0067528000000010024, 0.003759000000000512, 0.0019441000000011144, 0.0015884000000010445, 8.400000000463592e-06, 0.019772699999998977, 0.006331699999998719, 0.003833499999998935, 0.003527300000000011, 0.008624799999999766, 0.005995600000000323, 0.005152999999999963, 0.004572200000000137, 0.009751099999999013, 0.005671299999999491, 0.004605200000000309, 0.005278900000000419, 0.0056364999999996, 0.007312900000000511, 0.001172300000000348, 0.003933700000001039, 0.0027252000000004273, 0.007310399999999717, 0.00530580000000036, 0.0008297999999999917, 0.0018402000000001806] ;
% VNEM_time_10 = [7.299999999599294e-06, 7.800000000113272e-06, 0.0018301000000002787, 9.799999999948739e-06, 8.899999999645303e-06, 0.0016047000000001255, 0.0046255999999997854, 0.00889899999999999, 1.100000000020529e-05, 0.00478949999999978, 1.1699999999947863e-05, 1.3499999999666557e-05, 0.002667000000000197, 1.4100000000016877e-05, 1.3500000000554735e-05, 0.008871199999999746, 0.004752400000000101, 0.0015027999999999153, 0.003871599999999198, 0.016774300000000686, 1.979999999957016e-05, 5.7899999999833085e-05, 0.0016919999999993607, 0.0023301000000000016, 1.979999999957016e-05, 0.0031485999999993908, 0.01287980000000033, 0.00727110000000053, 0.00892930000000014, 0.0036775000000002223, 0.0011717000000004418, 0.008205600000000146, 0.005019899999999744, 0.010339400000000332, 0.005378600000000233, 0.005677000000000376, 0.002001600000000714, 0.009921100000000571, 0.01718279999999872, 0.002894500000000022, 0.004588399999999382, 0.009638600000000608, 0.0036807000000003143, 0.007175999999999405, 0.013064200000000525, 0.017874000000000834, 0.005383899999999997, 0.0115084999999997, 0.00963169999999991, 0.00832630000000023, 0.007805799999999863, 0.014379900000001555, 0.004932900000000018, 0.008919000000000565, 0.008181000000000438, 0.011343300000000056, 0.0035674999999990575, 0.007302300000000983, 0.0179311000000002, 0.008857799999999472, 0.003448600000000468, 0.0035836000000006862, 0.0036263000000005263, 0.008121199999999718, 0.011246500000000381, 0.005403599999999287] ;
% VNEM_time_15 = [0.008671899999999955, 8.79999999980896e-06, 7.999999999785956e-06, 0.0016457000000000832, 9.200000000042508e-06, 1.0300000000018628e-05, 9.600000000276054e-06, 1.1100000000041632e-05, 1.1199999999877974e-05, 1.2200000000017752e-05, 0.009421300000000077, 1.3399999999830214e-05, 2.4999999999941735e-05, 0.008316300000000165, 1.3299999999993872e-05, 1.4399999999525903e-05, 1.4400000000414082e-05, 0.0046058999999996075, 1.709999999999212e-05, 0.001434199999999386, 0.005564699999999867, 2.1499999999896602e-05, 0.004850500000000757, 0.0014562000000006847, 0.005202000000000595, 0.0011913000000003393, 2.0399999999476393e-05, 0.0013719999999999288, 0.0027460999999995295, 0.006079899999999583, 0.005369700000000144, 0.006015399999999893, 0.008773499999999324, 0.0015710000000002111, 0.009743900000000139, 0.008112300000000516, 0.0014516999999996116, 0.0026317000000002366, 0.008210599999999957, 0.010864400000000884, 0.014841599999998678, 0.0026878999999997433, 0.007608899999999252, 0.005552699999999078, 0.0011352999999996172, 0.008795700000000295, 0.012057100000001597, 0.003958700000000093, 0.010084500000001384, 0.007310099999999764, 0.014362799999998899, 0.011032900000000012, 0.010218800000000527, 0.013198100000000323, 0.00810970000000033, 0.020525900000000874, 0.006689700000000798, 0.014099700000000936, 0.012255899999999542, 0.00926920000000031, 0.005076100000000139, 0.010038999999999021, 0.00537519999999958, 0.013148400000000393, 0.008994500000000016, 0.008523499999999018] ;


figure;
hold on;
box on; % 显示边框

% 绘制直方图
bar(sfc_num, VNEM_time_5, 'FaceColor', '#1E90FF', 'EdgeColor', '#808A87','FaceAlpha', 0.5,'EdgeAlpha', 0.5,'DisplayName', 'VNEM Time (5,5)');
bar(sfc_num, VNEM_time_10, 'FaceColor', '#FF8C00', 'EdgeColor', '#808A87','FaceAlpha', 0.5,'EdgeAlpha', 0.5,'DisplayName', 'VNEM Time (10,10)');
bar(sfc_num, VNEM_time_15, 'FaceColor', '#32CD32', 'EdgeColor', '#808A87','FaceAlpha', 0.5,'EdgeAlpha', 0.5,'DisplayName', 'VNEM Time (15,15)');

% 用多项式拟合折线图
degree = 3;  % 拟合多项式的次数
coefficients1 = polyfit(sfc_num,VNEM_time_5, degree);
coefficients2 = polyfit(sfc_num,VNEM_time_10, degree);
coefficients3 = polyfit(sfc_num,VNEM_time_15, degree);

% 生成拟合曲线上的点
xFit = linspace(min(sfc_num), max(sfc_num), 100);
yFit1 = polyval(coefficients1, xFit);
yFit2 = polyval(coefficients2, xFit);
yFit3 = polyval(coefficients3, xFit);


% 连接方块中点
bin_centers = sfc_num;   % 计算每个方块的中点
% plot(bin_centers, VNEM_time_5, '-*','Color','#1E90FF', 'LineWidth', 0.8,'HandleVisibility', 'off');
% plot(bin_centers, VNEM_time_10, '-*','Color','#FF8C00', 'LineWidth', 0.8,'HandleVisibility', 'off');
% plot(bin_centers, VNEM_time_15, '-*','Color','#2E8B57', 'LineWidth', 0.8,'HandleVisibility', 'off');

plot(xFit, yFit1, '-*','Color','#1E90FF', 'LineWidth', 0.8,'DisplayName', 'VNEM Time Trends (5,5)');
plot(xFit, yFit2, '-*','Color','#FF8C00', 'LineWidth', 0.8,'DisplayName', 'VNEM Time Trends (10,10)');
plot(xFit, yFit3, '-*','Color','#2E8B57', 'LineWidth', 0.8,'DisplayName', 'VNEM Time Trends (15,15)');
ax = gca;
ax.YAxis.Exponent = -2;
xlabel('SFC Number','FontSize',12)  %x轴坐标描述
ylabel('VNEM Response Time (s)','FontSize',12) %y轴坐标描述
legend('NumColumns',1,'location','northwest');   %右上角标注
% hold off;